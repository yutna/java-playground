#!/usr/bin/env ruby

class Java
  attr_accessor :folders, :sum

  def self.compile(folders = [])
    compiler = Java.new(folders)

    if compiler.execute
      puts "All Java files compiled successfully."
      puts "Total compiled files: #{compiler.sum}"
    else
      puts "Compilation failed."
    end
  end

  def initialize(folders)
    @folders = folders
    @sum = 0
  end

  def execute
    @folders.each do |folder|
      subdirectories = Dir.glob("#{folder}/**/*/").select { |file| File.directory?(file) }
      subdirectories.each do |subdir|
        Dir.chdir(subdir) do
          java_files = Dir.glob('*.java')
          @sum += java_files.size

          unless system("javac *.java")
            puts "Failed to compile in directory: #{Dir.pwd}"
            return false
          end
        end
      end
    end

    true
  end
end

Java.compile([
  'beginners-guide'
])
