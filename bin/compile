#!/usr/bin/env ruby

class Java
  attr_accessor :folders, :sum

  def self.compile
    compiler = Java.new

    if compiler.execute
      puts "All Java files compiled successfully."
      puts "Total compiled files: #{compiler.sum}"
    end
  end

  def initialize
    @sum = 0
  end

  def execute
    subdirectories = Dir.glob("./**/*/").select { |file| File.directory?(file) }
    subdirectories.each do |subdir|
      Dir.chdir(subdir) do
        java_files = Dir.glob('*.java')
        if java_files.length > 0
          @sum += java_files.size

          unless system("javac *.java")
            puts "Failed to compile in directory: #{Dir.pwd}"
            return false
          end
        end
      end
    end

    true
  end
end

Java.compile()
